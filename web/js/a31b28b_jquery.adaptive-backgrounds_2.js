(function(e){var c="data-ab-color";var d="data-ab-parent";var f="data-ab-css-background";var b="ab-color-found";var a={selector:"[data-adaptive-background]",parent:null,exclude:["rgb(0,0,0)","rgb(255,255,255)"],normalizeTextColor:false,normalizedTextColors:{light:"#fff",dark:"#000"},lumaClasses:{light:"ab-light",dark:"ab-dark"}};!function(q){var j=function(){return document.createElement("canvas").getContext("2d")},l=function(t,r){var i=new Image,s=t.src||t;"data:"!==s.substring(0,5)&&(i.crossOrigin="Anonymous"),i.onload=function(){var v=j("2d");v.drawImage(i,0,0);var u=v.getImageData(0,0,i.width,i.height);r&&r(u.data)},i.src=s},g=function(i){return["rgb(",i,")"].join("")},m=function(i){return i.map(function(o){return g(o.name)})},k=5,h=10,p={};p.colors=function(s,o){o=o||{};var r=o.exclude||[],i=o.paletteSize||h;l(s,function(y){for(var v=s.width*s.height||y.length,t={},A="",z=[],x={dominant:{name:"",count:0},palette:Array.apply(null,new Array(i)).map(Boolean).map(function(){return{name:"0,0,0",count:0}})},u=0;v>u;){if(z[0]=y[u],z[1]=y[u+1],z[2]=y[u+2],A=z.join(","),t[A]=A in t?t[A]+1:1,-1===r.indexOf(g(A))){var w=t[A];w>x.dominant.count?(x.dominant.name=A,x.dominant.count=w):x.palette.some(function(B){return w>B.count?(B.name=A,B.count=w,!0):void 0})}u+=4*k}if(o.success){var n=m(x.palette);o.success({dominant:g(x.dominant.name),secondary:n[0],palette:n})}})},q.RGBaster=q.RGBaster||p}(window);e.adaptiveBackground={run:function(g){var h=e.extend({},a,g);e(h.selector).each(function(j,m){var n=e(this);var l=function(){var o=k()?i():n[0];RGBaster.colors(o,{paletteSize:20,exclude:h.exclude,success:function(p){n.attr(c,p.dominant);n.trigger(b,{color:p.dominant,palette:p.palette})}})};var k=function(){var o=n.attr(f);return(typeof o!==typeof undefined&&o!==false)};var i=function(){var q=n.css("background-image");var p=/\(([^)]+)\)/;var o=p.exec(q)[1].replace(/"/g,"");return o};n.on(b,function(p,q){var t;if(h.parent&&n.parents(h.parent).length){t=n.parents(h.parent)}else{if(n.attr(d)&&n.parents(n.attr(d)).length){t=n.parents(n.attr(d))}else{if(k()){t=n}else{if(h.parent){t=n.parents(h.parent)}else{t=n.parent()}}}}t.css({backgroundColor:q.color});var s=function(u){var v=u.match(/\d+/g);return((v[0]*299)+(v[1]*587)+(v[2]*114))/1000};var r=function(u){return s(u)>=128?h.normalizedTextColors.dark:h.normalizedTextColors.light};var o=function(u){return s(u)<=128?h.lumaClasses.dark:h.lumaClasses.light};if(h.normalizeTextColor){t.css({color:r(q.color)})}t.addClass(o(q.color)).attr("data-ab-yaq",s(q.color));h.success&&h.success(n,q)});l()})}}})(jQuery);